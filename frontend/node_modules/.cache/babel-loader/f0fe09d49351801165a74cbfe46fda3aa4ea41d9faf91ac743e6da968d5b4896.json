{"ast":null,"code":"var _jsxFileName = \"D:\\\\lessonsatuniversity\\\\CongNgheWebVaDichVuTrucTuyen\\\\Project\\\\IT4409\\\\frontend\\\\src\\\\MapContainer.js\",\n  _s = $RefreshSig$();\n// frontend/src/MapContainer.js\nimport React, { useState, useEffect } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport axios from 'axios';\n\n// Tọa độ trung tâm Hà Nội (Latitude, Longitude)\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst hanoiPosition = [21.028511, 105.854199];\nconst INITIAL_ZOOM = 12;\nconst LeafletMapComponent = () => {\n  _s();\n  const [locations, setLocations] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // 1. Gọi API Backend để lấy dữ liệu địa điểm\n  useEffect(() => {\n    const fetchLocations = async () => {\n      try {\n        setLoading(true);\n        // Backend API Endpoint của bạn\n        const response = await axios.get('http://localhost:5000/api/locations');\n\n        // Dữ liệu từ Backend (lưu ý: tọa độ là string, cần Parse)\n        setLocations(response.data.data);\n        setLoading(false);\n      } catch (err) {\n        console.error(\"Lỗi khi lấy dữ liệu địa điểm:\", err);\n        setError(\"Không thể tải dữ liệu địa điểm từ Backend.\");\n        setLoading(false);\n      }\n    };\n    fetchLocations();\n  }, []);\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"\\u0110ang t\\u1EA3i b\\u1EA3n \\u0111\\u1ED3 v\\xE0 d\\u1EEF li\\u1EC7u...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"p\", {\n    style: {\n      color: 'red'\n    },\n    children: [\"L\\u1ED7i: \", error]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 21\n  }, this);\n  return (\n    /*#__PURE__*/\n    // 2. MapContainer: Thiết lập bản đồ\n    _jsxDEV(MapContainer, {\n      center: hanoiPosition,\n      zoom: INITIAL_ZOOM,\n      scrollWheelZoom: true,\n      className: \"map-container-leaflet\" // Sử dụng class CSS đã định nghĩa\n      ,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 7\n      }, this), locations.map(loc => {\n        // Chuyển đổi chuỗi tọa độ thành số (BẮT BUỘC)\n        const lat = parseFloat(loc.latitude);\n        const lng = parseFloat(loc.longitude);\n\n        // Kiểm tra tọa độ hợp lệ trước khi render\n        if (isNaN(lat) || isNaN(lng)) return null;\n        return /*#__PURE__*/_jsxDEV(Marker, {\n          position: [lat, lng],\n          title: loc.name,\n          children: /*#__PURE__*/_jsxDEV(Popup, {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: loc.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 15\n            }, this), \"\\u0110\\xE1nh gi\\xE1: \", loc.average_rating || 'Chưa có', \" (\", loc.review_count || 0, \" l\\u01B0\\u1EE3t)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 13\n          }, this)\n        }, loc.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 5\n    }, this)\n  );\n};\n_s(LeafletMapComponent, \"lyqqJySOUP3kBHrSwUSHlvdlzIo=\");\n_c = LeafletMapComponent;\nexport default LeafletMapComponent;\nvar _c;\n$RefreshReg$(_c, \"LeafletMapComponent\");","map":{"version":3,"names":["React","useState","useEffect","MapContainer","TileLayer","Marker","Popup","axios","jsxDEV","_jsxDEV","hanoiPosition","INITIAL_ZOOM","LeafletMapComponent","_s","locations","setLocations","loading","setLoading","error","setError","fetchLocations","response","get","data","err","console","children","fileName","_jsxFileName","lineNumber","columnNumber","style","color","center","zoom","scrollWheelZoom","className","attribution","url","map","loc","lat","parseFloat","latitude","lng","longitude","isNaN","position","title","name","average_rating","review_count","id","_c","$RefreshReg$"],"sources":["D:/lessonsatuniversity/CongNgheWebVaDichVuTrucTuyen/Project/IT4409/frontend/src/MapContainer.js"],"sourcesContent":["// frontend/src/MapContainer.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\r\nimport axios from 'axios';\r\n\r\n// Tọa độ trung tâm Hà Nội (Latitude, Longitude)\r\nconst hanoiPosition = [21.028511, 105.854199];\r\nconst INITIAL_ZOOM = 12;\r\n\r\nconst LeafletMapComponent = () => {\r\n  const [locations, setLocations] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  // 1. Gọi API Backend để lấy dữ liệu địa điểm\r\n  useEffect(() => {\r\n    const fetchLocations = async () => {\r\n      try {\r\n        setLoading(true);\r\n        // Backend API Endpoint của bạn\r\n        const response = await axios.get('http://localhost:5000/api/locations');\r\n        \r\n        // Dữ liệu từ Backend (lưu ý: tọa độ là string, cần Parse)\r\n        setLocations(response.data.data);\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error(\"Lỗi khi lấy dữ liệu địa điểm:\", err);\r\n        setError(\"Không thể tải dữ liệu địa điểm từ Backend.\");\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchLocations();\r\n  }, []);\r\n  \r\n  if (loading) return <p>Đang tải bản đồ và dữ liệu...</p>;\r\n  if (error) return <p style={{ color: 'red' }}>Lỗi: {error}</p>;\r\n\r\n  return (\r\n    // 2. MapContainer: Thiết lập bản đồ\r\n    <MapContainer \r\n      center={hanoiPosition} \r\n      zoom={INITIAL_ZOOM} \r\n      scrollWheelZoom={true}\r\n      className=\"map-container-leaflet\" // Sử dụng class CSS đã định nghĩa\r\n    >\r\n      \r\n      {/* 3. TileLayer: Lớp nền bản đồ (OpenStreetMap) */}\r\n      <TileLayer\r\n        attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n      />\r\n      \r\n      {/* 4. Hiển thị Markers cho từng địa điểm */}\r\n      {locations.map((loc) => {\r\n        // Chuyển đổi chuỗi tọa độ thành số (BẮT BUỘC)\r\n        const lat = parseFloat(loc.latitude);\r\n        const lng = parseFloat(loc.longitude);\r\n        \r\n        // Kiểm tra tọa độ hợp lệ trước khi render\r\n        if (isNaN(lat) || isNaN(lng)) return null; \r\n\r\n        return (\r\n          <Marker \r\n            key={loc.id} \r\n            position={[lat, lng]} \r\n            title={loc.name}\r\n          >\r\n            {/* Popup: Hiển thị thông tin khi click vào Marker */}\r\n            <Popup>\r\n              <strong>{loc.name}</strong>\r\n              <br/>\r\n              Đánh giá: {loc.average_rating || 'Chưa có'} ({loc.review_count || 0} lượt)\r\n            </Popup>\r\n          </Marker>\r\n        );\r\n      })}\r\n    </MapContainer>\r\n  );\r\n};\r\n\r\nexport default LeafletMapComponent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}