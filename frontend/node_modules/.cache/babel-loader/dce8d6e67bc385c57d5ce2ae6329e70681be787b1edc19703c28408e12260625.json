{"ast":null,"code":"var _jsxFileName = \"D:\\\\lessonsatuniversity\\\\CongNgheWebVaDichVuTrucTuyen\\\\Project\\\\IT4409\\\\frontend\\\\src\\\\LocationCRUD.js\",\n  _s = $RefreshSig$();\n// frontend/src/LocationCRUD.js (CODE ĐÃ SỬA)\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useAuth } from './context/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_URL = 'http://localhost:5000/api/locations';\nconst LocationCRUD = () => {\n  _s();\n  // --- 1. HOOKS (PHẢI Ở TRÊN CÙNG) ---\n  const [locations, setLocations] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [isEditing, setIsEditing] = useState(false);\n  const [formData, setFormData] = useState({});\n  const [error, setError] = useState(null);\n  const {\n    userRole,\n    authHeaders\n  } = useAuth(); // <--- Hook\n\n  // Hàm Tải Dữ liệu (Sử dụng useCallback để tránh lỗi dependencies)\n  const fetchLocations = async () => {\n    // ... (logic fetch giữ nguyên) ...\n  };\n\n  // 2. useEffect: Tải dữ liệu lần đầu (PHẢI Ở CẤP CAO NHẤT)\n  useEffect(() => {\n    // Chỉ tải dữ liệu nếu người dùng là admin\n    if (userRole === 'admin') {\n      fetchLocations();\n    }\n  }, [userRole]); // Chạy khi component mount hoặc khi userRole thay đổi\n\n  // --- 3. ĐIỀU KIỆN TRẢ VỀ SỚM (NON-ADMIN) ---\n  // VỊ TRÍ MỚI: Đặt sau TẤT CẢ các Hooks (useState, useEffect, useAuth, v.v.)\n  if (userRole !== 'admin') {\n    return null;\n  }\n\n  // --- 4. LOGIC VÀ RENDER (Giữ nguyên) ---\n  // ... (các hàm handleChange, handleSubmit, handleDelete giữ nguyên) ...\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"\\u0110ang t\\u1EA3i danh s\\xE1ch Admin...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 23\n  }, this);\n\n  // Render Giao diện Admin\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      margin: '20px',\n      padding: '20px',\n      border: '1px solid #ccc'\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n};\n_s(LocationCRUD, \"GRt4OqplCBiAv2cs6yThiSm+sMA=\", false, function () {\n  return [useAuth];\n});\n_c = LocationCRUD;\nexport default LocationCRUD;\nvar _c;\n$RefreshReg$(_c, \"LocationCRUD\");","map":{"version":3,"names":["React","useState","useEffect","axios","useAuth","jsxDEV","_jsxDEV","API_URL","LocationCRUD","_s","locations","setLocations","loading","setLoading","isEditing","setIsEditing","formData","setFormData","error","setError","userRole","authHeaders","fetchLocations","children","fileName","_jsxFileName","lineNumber","columnNumber","style","margin","padding","border","_c","$RefreshReg$"],"sources":["D:/lessonsatuniversity/CongNgheWebVaDichVuTrucTuyen/Project/IT4409/frontend/src/LocationCRUD.js"],"sourcesContent":["// frontend/src/LocationCRUD.js (CODE ĐÃ SỬA)\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useAuth } from './context/AuthContext'; \r\n\r\nconst API_URL = 'http://localhost:5000/api/locations';\r\n\r\nconst LocationCRUD = () => {\r\n  // --- 1. HOOKS (PHẢI Ở TRÊN CÙNG) ---\r\n  const [locations, setLocations] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [formData, setFormData] = useState({});\r\n  const [error, setError] = useState(null);\r\n  \r\n  const { userRole, authHeaders } = useAuth(); // <--- Hook\r\n  \r\n  // Hàm Tải Dữ liệu (Sử dụng useCallback để tránh lỗi dependencies)\r\n  const fetchLocations = async () => {\r\n    // ... (logic fetch giữ nguyên) ...\r\n  };\r\n  \r\n  // 2. useEffect: Tải dữ liệu lần đầu (PHẢI Ở CẤP CAO NHẤT)\r\n  useEffect(() => {\r\n    // Chỉ tải dữ liệu nếu người dùng là admin\r\n    if (userRole === 'admin') {\r\n      fetchLocations();\r\n    }\r\n  }, [userRole]); // Chạy khi component mount hoặc khi userRole thay đổi\r\n\r\n  // --- 3. ĐIỀU KIỆN TRẢ VỀ SỚM (NON-ADMIN) ---\r\n  // VỊ TRÍ MỚI: Đặt sau TẤT CẢ các Hooks (useState, useEffect, useAuth, v.v.)\r\n  if (userRole !== 'admin') {\r\n    return null; \r\n  }\r\n  \r\n  // --- 4. LOGIC VÀ RENDER (Giữ nguyên) ---\r\n  // ... (các hàm handleChange, handleSubmit, handleDelete giữ nguyên) ...\r\n\r\n  if (loading) return <p>Đang tải danh sách Admin...</p>;\r\n\r\n  // Render Giao diện Admin\r\n  return (\r\n    <div style={{ margin: '20px', padding: '20px', border: '1px solid #ccc' }}>\r\n        {/* ... (Phần render giao diện CRUD giữ nguyên) ... */}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LocationCRUD;"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEhD,MAAMC,OAAO,GAAG,qCAAqC;AAErD,MAAMC,YAAY,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACzB;EACA,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACW,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACa,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACe,QAAQ,EAAEC,WAAW,CAAC,GAAGhB,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC5C,MAAM,CAACiB,KAAK,EAAEC,QAAQ,CAAC,GAAGlB,QAAQ,CAAC,IAAI,CAAC;EAExC,MAAM;IAAEmB,QAAQ;IAAEC;EAAY,CAAC,GAAGjB,OAAO,CAAC,CAAC,CAAC,CAAC;;EAE7C;EACA,MAAMkB,cAAc,GAAG,MAAAA,CAAA,KAAY;IACjC;EAAA,CACD;;EAED;EACApB,SAAS,CAAC,MAAM;IACd;IACA,IAAIkB,QAAQ,KAAK,OAAO,EAAE;MACxBE,cAAc,CAAC,CAAC;IAClB;EACF,CAAC,EAAE,CAACF,QAAQ,CAAC,CAAC,CAAC,CAAC;;EAEhB;EACA;EACA,IAAIA,QAAQ,KAAK,OAAO,EAAE;IACxB,OAAO,IAAI;EACb;;EAEA;EACA;;EAEA,IAAIR,OAAO,EAAE,oBAAON,OAAA;IAAAiB,QAAA,EAAG;EAA2B;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAG,CAAC;;EAEtD;EACA,oBACErB,OAAA;IAAKsB,KAAK,EAAE;MAAEC,MAAM,EAAE,MAAM;MAAEC,OAAO,EAAE,MAAM;MAAEC,MAAM,EAAE;IAAiB;EAAE;IAAAP,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAErE,CAAC;AAEV,CAAC;AAAClB,EAAA,CAxCID,YAAY;EAAA,QAQkBJ,OAAO;AAAA;AAAA4B,EAAA,GARrCxB,YAAY;AA0ClB,eAAeA,YAAY;AAAC,IAAAwB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}